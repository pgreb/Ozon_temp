import json
import pandas as pd

# Ваш JSON-строка (замените на реальную строку)
json_string = """
[
    {
        "dimensions": [{"id": "908041183", "name": "Кружка 250 мл Хвост розовая / Кружка детская и взрослая небьющаяся из полимера / Кружка для горячих и холодных напитков / Чашка чайная с Котиком и хвостиком / Подарочная кружка с принтом / Пиала для чая, кофе, компота и сока / Кружка дорожная"}],
        "metrics": [9189, 47, 76762, 1773, 5, 41, 139.08035225762748, 84972]
    },
    {
        "dimensions": [{"id": "816439074", "name": "Обучающая насадка на карандаш Дельфины, ручку для правильного письма 4 шт"}],
        "metrics": [155530.78, 1190, 59322, 7951, 38, 1019, 25.698278913743405, 230735]
    },
    {
        "dimensions": [{"id": "816368581", "name": "Обучающая насадка на карандаш, ручку для правильного письма 4 шт / Тренажер для постановки письма"}],
        "metrics": [41873.22, 288, 44082, 3413, 12, 274, 25.40984982532553, 67731]
    },
    {
        "dimensions": [{"id": "970729796", "name": "Тормозные ручки 61 для велосипеда, самоката 2 шт. черные / Рукоятки тормоза на велосипед"}],
        "metrics": [40167, 108, 40513, 1914, 10, 110, 47.404931750302374, 67464]
    },
    {
        "dimensions": [{"id": "970361422", "name": "Тормозные ручки для велосипеда, самоката 2 шт. / Рукоятки тормоза на велосипед"}],
        "metrics": [52344, 143, 36018, 2580, 9, 123, 43.5221278249764, 51601]
    },
    {
        "dimensions": [{"id": "849214784", "name": "Грипсы черные 80 мм"}],
        "metrics": [31410, 143, 33198, 1606, 10, 130, 44.648051087414906, 76281]
    },
    {
        "dimensions": [{"id": "882386148", "name": "Бейдж для школьника голубой / бейджик на ленте / бедж для пропуска с рулеткой"}],
        "metrics": [8402, 44, 30396, 1457, 3, 41, 97.94722989867088, 40559]
    },
    {
        "dimensions": [{"id": "813984969", "name": "Грипсы велосипедные 125 мм красные HG 63 (ручки на руль) для самоката, велосипеда, беговела / Ручки для трюкового самоката на руль"}],
        "metrics": [5911, 24, 29678, 428, 0, 19, 137.03406563784623, 43022]
    },
    {
        "dimensions": [{"id": "891378521", "name": "Прищепка декоративная деревянная разноцветная 32 шт / Мини прищепки для украшения, творчества, фотографий, открыток, скрапбукинга"}],
        "metrics": [47373, 274, 28678, 3814, 20, 226, 41.47112769370249, 106383]
    },
    {
        "dimensions": [{"id": "973197423", "name": "Грипсы велосипедные 120 мм черные HG 60 для самоката / беговела / велосипеда"}],
        "metrics": [5818, 31, 25866, 465, 2, 29, 102.78883476378257, 30089]
    }
]
"""

# Преобразование JSON-строки в объект Python
json_data = json.loads(json_string)

# Далее следует ваш код для записи данных в Excel


# Список метрик, которые мы хотим учесть
metrics_list = ['revenue', 'ordered_units', 'unknown_metric', 'hits_view_search', 'hits_view_pdp', 'cancellations', 'delivered_units', 'position_category', 'hits_view']

# Переменная для хранения данных
data_dict = {}

# Обработка JSON-данных
for item in json_data:
    dimensions_values = item['dimensions'][0]
    metrics_values = item['metrics']

    # Обработка dimensions
    for key, value in dimensions_values.items():
        if key not in data_dict:
            data_dict[key] = [value]
        else:
            data_dict[key].append(value)

    # Обработка metrics
    for i, metric_value in enumerate(metrics_values):
        metric_name = metrics_list[i]
        if metric_name not in data_dict:
            data_dict[metric_name] = [metric_value]
        else:
            data_dict[metric_name].append(metric_value)

# Печать данных для проверки
print(data_dict)

# Создание DataFrame
df = pd.DataFrame(data_dict)

# Запись в Excel
df.to_excel('output.xlsx', index=False)
